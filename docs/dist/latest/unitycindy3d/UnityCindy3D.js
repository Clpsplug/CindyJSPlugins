(function(){
'use strict';CindyJS.registerPlugin(1,"UnityCindy3D",function(d){var c=d.nada,e=d.evaluate;d=d.defineFunction;var k=[],f=-1,h=0,g=function(){if("undefined"==typeof uc3dBuffer)return!1;h=0;return!0},l=function(a){uc3dBuffer[h++]=a},q=function(a){uc3dBuffer[h++]=a},p=function(a,b,c){uc3dBuffer[h++]=c;for(var d=b;d<b+c;++d)for(var m=coerce.toHomog(e(a[d])),f=0;3>f;f++)uc3dBuffer[h++]=m[f]},u=function(a){var b=a.length;uc3dBuffer[h++]=b;for(var c=0;c<b;++c)for(var d=coerce.toHomog(a[c]),e=0;3>e;e++)uc3dBuffer[h++]=
d[e]},r=function(a,b,c){var d=null,m=b,f=null;b={color:function(a){return d=coerce.toColor(a)},alpha:function(a){return coerce.toInterval(0,1,a)},shininess:function(a){return coerce.toInterval(0,128,a)},size:function(a){return m=coerce.toReal(a)},topology:function(a){return f=coerce.toString(a,f).toLowerCase()}};for(var g in a){var k=b[g];null!=k&&k(e(a[g]))}null!=d&&(uc3dBuffer[h++]=1,uc3dBuffer[h++]=d[0],uc3dBuffer[h++]=d[1],uc3dBuffer[h++]=d[2]);if(null!=c)for(uc3dBuffer[h++]=2,uc3dBuffer[h++]=
c.length,a=0;a<c.length;++a)g=coerce.toColor(c[a]),uc3dBuffer[h++]=g[0],uc3dBuffer[h++]=g[1],uc3dBuffer[h++]=g[2];null!=m&&(uc3dBuffer[h++]=0,uc3dBuffer[h++]=m);null!=f&&(uc3dBuffer[h++]=3,"close"==f?uc3dBuffer[h++]=1:uc3dBuffer[h++]=0);uc3dBuffer[h]=-1};d("clear3d",0,function(a,b){if(0==g())return c;gameInstance.SendMessage("Manager","Clear3D","");k=[];f=-1;h=0;return c});d("begin3d",0,function(a,b){return t("Default",b,!0)});d("begin3d",1,function(a,b){return t(coerce.toString(e(a[0])),b,!0)});
d("createprototype3d",1,function(a,b){return t(coerce.toString(e(a[0])),b,!1)});var t=function(a,b,d){if(-1!=f||0==g())return c;q(d);gameInstance.SendMessage("Manager","Begin3D",a);f=Math.floor(uc3dBuffer[0]);k[f]={id:f,name:{ctype:"string",value:a},active:d,init:!1,start:null,redraw:null,update:null,collisionenter:null};return{ctype:"number",value:{real:f,imag:0}}};d("instantiate3d",2,function(a,b){return{ctype:"number",value:{real:v(a,b,!0),imag:0}}});d("extends3d",1,function(a,b){var c=-1;-1==
f&&(f=c=v(a,b,!1));return{ctype:"number",value:{real:c,imag:0}}});var v=function(a,b,c){b=-1;if(0==g())return b;var d=coerce.toInt(e(a[0])),m=k[d];m&&(l(d),q(c),c&&p(a,1,1),gameInstance.SendMessage("Manager","Instantiate3D",""),b=Math.floor(uc3dBuffer[0]),a=JSON.parse(JSON.stringify(m)),a.id=b,a.active=c,a.init=!1,k[b]=a);return b};d("end3d",0,function(a,b){if(-1==f||0==g())return c;gameInstance.SendMessage("Manager","End3D","");f=-1;return c});d("oncollisionenter3d",2,function(a,b){b=coerce.toInt(e(a[0]));
a=coerce.toInt(e(a[1]));b=k[b];if(!b)return c;null!=b.collisionenter&&(f=b.id,cdy.evokeCS(b.collisionenter+"("+a+");"));f=-1;return c});d("destroy3d",1,function(a,b){return w(f,a,0,b)});d("destroy3d",2,function(a,b){return w(coerce.toInt(e(a[0])),a,1,b)});var w=function(a,b,d,f){if(-1==a||0==g())return c;b=coerce.toReal(e(b[d]));l(a);q(b);gameInstance.SendMessage("Manager","Destroy3D","");return c};d("ondestroy3d",1,function(a,b){a=coerce.toInt(e(a[0]));delete k[a];return c});d("draw3d",1,function(a,
b){if(-1==f||0==g())return c;p(a,0,1);r(b,null,null);gameInstance.SendMessage("Manager","AddPoint3D","");return c});d("draw3d",2,function(a,b){if(-1==f||0==g())return c;p(a,0,2);r(b,null,null);gameInstance.SendMessage("Manager","AddLine3D","");return c});d("connect3d",1,function(a,b){return x(a,b)});d("connect3d",2,function(a,b){return x(a,b)});var x=function(a,b){if(-1==f||0==g())return c;u(coerce.toList(e(a[0])));var d=null;2==a.length&&(d=coerce.toList(e(a[1])));r(b,null,d);gameInstance.SendMessage("Manager",
"AddLine3D","");return c};d("fillpoly3d",1,function(a,b){if(-1==f||0==g())return c;u(coerce.toList(e(a[0])));r(b,null,null);gameInstance.SendMessage("Manager","AddPolygon3D","");return c});d("drawsphere3d",2,function(a,b){if(-1==f||0==g())return c;p(a,0,1);a=coerce.toReal(e(a[1]));r(b,a,null);gameInstance.SendMessage("Manager","AddSphere3D","");return c});d("setactive3d",1,function(a,b){return y(f,a,0,b)});d("setactive3d",2,function(a,b){return y(coerce.toInt(e(a[0])),a,1,b)});var y=function(a,b,
d,f){if(-1==a||0==g())return c;f=k[a];if(!f)return c;b=coerce.toBool(e(b[d+1]));f.active=b;l(a);q(b);gameInstance.SendMessage("Manager","SetActive3D","");return c};d("usegravity3d",1,function(a,b){return z(f,a,0,b)});d("usegravity3d",2,function(a,b){return z(coerce.toInt(e(a[0])),a,1,b)});var z=function(a,b,d,f){if(-1==a||0==g())return c;b=coerce.toBool(e(b[d]));l(a);q(b);gameInstance.SendMessage("Manager","UseGravity3D","");return c};d("addcollider3d",0,function(a,b){return A(f,a,b)});d("addcollider3d",
1,function(a,b){return A(coerce.toInt(e(a[0])),a,b)});var A=function(a,b,d){if(-1==a||0==g())return c;l(a);gameInstance.SendMessage("Manager","AddCollider3D","");return c};d("setmass3d",1,function(a,b){return B(f,a,0,b)});d("setmass3d",2,function(a,b){return B(coerce.toInt(e(a[0])),a,1,b)});var B=function(a,b,d,f){if(-1==a||0==g())return c;b=coerce.toReal(e(b[d]));l(a);q(b);gameInstance.SendMessage("Manager","SetMass3D","");return c};d("get3d",1,function(a,b){return C(f,a,0,b)});d("get3d",2,function(a,
b){return C(coerce.toInt(e(a[0])),a,1,b)});var C=function(a,b,d,f){if(-1==a||0==g())return c;a=k[a];if(!a)return c;b=coerce.toString(e(b[d]));return a[b]?a[b]:c};d("set3d",2,function(a,b){return D(f,a,0,b)});d("set3d",3,function(a,b){return D(coerce.toInt(e(a[0])),a,1,b)});var D=function(a,b,d,f){if(-1==a||0==g())return c;a=k[a];if(!a)return c;f=coerce.toString(e(b[d]));a[f]=e(b[d+1]);return c};d("setstart3d",1,function(a,b){return n(f,"start","();",a,0,b)});d("setstart3d",2,function(a,b){return n(coerce.toInt(e(a[0])),
"start","();",a,1,b)});d("setredraw3d",1,function(a,b){return n(f,"redraw","();",a,0,b)});d("setredraw3d",2,function(a,b){return n(coerce.toInt(e(a[0])),"redraw","();",a,1,b)});d("setupdate3d",1,function(a,b){return n(f,"update","();",a,0,b)});d("setupdate3d",2,function(a,b){return n(coerce.toInt(e(a[0])),"update","();",a,1,b)});d("setcollisionenter3d",1,function(a,b){return n(f,"collisionenter","",a,0,b)});d("setcollisionenter3d",2,function(a,b){return n(coerce.toInt(e(a[0])),"collisionenter","",
a,1,b)});var n=function(a,b,d,e,f,g){if(-1==a)return c;a=k[a];if(!a)return c;if("function"!==e[f].ctype)return console.log("argument is not a function"),c;a[b]=e[f].oper.replace(/\$.*/g,d);return c};d("redraw3d",0,function(a,b){k.forEach(function(a){a.active&&(a.init||null==a.start||(f=a.id,cdy.evokeCS(a.start),a.init=!0),null!=a.redraw&&(f=a.id,cdy.evokeCS(a.redraw)))});f=-1;return c});d("update3d",0,function(a,b){if(null==cdy)return c;k.forEach(function(a){a.active&&(a.init||null==a.start||(f=a.id,
cdy.evokeCS(a.start),a.init=!0),null!=a.update&&(f=a.id,cdy.evokeCS(a.update)))});f=-1;return c});d("setposition3d",1,function(a,b){return E(f,a,0,b)});d("setposition3d",2,function(a,b){return E(coerce.toInt(e(a[0])),a,1,b)});var E=function(a,b,d,e){if(-1==a||0==g())return c;l(a);p(b,d,1);gameInstance.SendMessage("Manager","SetPosition3D","");return c};d("getposition3d",0,function(a,b){return F(f,a,0,b)});d("getposition3d",1,function(a,b){return F(coerce.toInt(e(a[0])),a,1,b)});var F=function(a,b,
d,e){if(-1==a||0==g())return c;l(a);gameInstance.SendMessage("Manager","GetPosition3D","");return{ctype:"list",value:[{ctype:"number",value:{real:uc3dBuffer[0],imag:0}},{ctype:"number",value:{real:uc3dBuffer[1],imag:0}},{ctype:"number",value:{real:uc3dBuffer[2],imag:0}}]}};d("setrotation3d",1,function(a,b){return G(f,a,0,b)});d("setrotation3d",2,function(a,b){return G(coerce.toInt(e(a[0])),a,1,b)});var G=function(a,b,d,e){if(-1==a||0==g())return c;l(a);p(b,d,1);gameInstance.SendMessage("Manager",
"SetRotation3D","");return c};d("setvelocity3d",1,function(a,b){return H(f,a,0,b)});d("setvelocity3d",2,function(a,b){return H(coerce.toInt(e(a[0])),a,1,b)});var H=function(a,b,d,e){if(-1==a||0==g())return c;l(a);p(b,d,1);gameInstance.SendMessage("Manager","SetVelocity3D","");return c};d("getkey3d",1,function(a,b){b=!1;if(0==g())return c;gameInstance.SendMessage("Manager","GetKey3D",coerce.toString(e(a[0])));uc3dBuffer[0]&&(b=!0);return{ctype:"boolean",value:b}})});var coerce={toList:function(d,c){c=void 0===c?null:c;return"list"!==d.ctype?(console.log("argument is not a list"),c):d.value},toHomog:function(d,c,e){c=void 0===c?[0,0,0,0]:c;e=void 0===e?3:e;d=coerce.toList(d);if(null===d)return c;c=d.map(coerce.toReal);c.length>e+1&&(console.log("Coordinate vector too long."),c=c.slice(0,e+1));for(;c.length<e;)c.push(0);c.length===e&&c.push(1);return c},toDirection:function(d,c){c=void 0===c?[0,0,0]:c;d=coerce.toList(d);if(null===d)return c;c=d.map(coerce.toReal);
3<c.length&&(console.log("Coordinate vector too long."),c=c.slice(0,3));for(;3>c.length;)c.push(0);return c},toDirectionPoint:function(d,c){c=void 0===c?[0,0,0,0]:c;d=coerce.toDirection(d,c);d!==c&&(d[3]=0);return d},toColor:function(d,c){c=void 0===c?[.5,.5,.5]:c;if("number"===d.ctype){var e=coerce.toInterval(0,1,d);if(!isNaN(e))return[e,e,e]}d=coerce.toList(d);return null===d?c:3!=d.length?(console.log("Not an RGB color vector"),c):d.map(function(c){return coerce.toInterval(0,1,c)})},toReal:function(d,
c){c=void 0===c?Number.NaN:c;if("number"!==d.ctype)return console.log("argument is not a number"),c;d=d.value;c=d.real;0!==d.imag&&console.log("complex number is not real");return c},toInt:function(d,c){c=void 0===c?Number.NaN:c;if("number"!==d.ctype)return console.log("argument is not a number"),c;c=d.value;d=c.real;c=c.imag;0!==c&&console.log("complex number is not real");c=Math.round(d);c!==d&&console.log("number is not an integer");return c},clamp:function(d,c,e){return e<d?d:e>c?c:e},toInterval:function(d,
c,e,k){k=void 0===k?Number.NaN:k;return coerce.clamp(d,c,coerce.toReal(e,k))},toString:function(d,c){c=void 0===c?null:c;if("string"===d.ctype)return d.value;console.log("argument is not a string");return c},toEnum:function(d,c,e){e=void 0===e?null:e;c=coerce.toString(c,e);if(c!==e&&-1!==d.indexOf(c))return c;console.log("argument is not one of "+d.join(", "));return e},toBool:function(d,c){if("boolean"===d.ctype)return d.value;console.log("argument is not boolean");return c}};
}).call(this);

