(function(){
'use strict';CindyJS.registerPlugin(1,"UnityCindy3D",function(c){var a=c.nada,d=c.evaluate;c=c.defineFunction;var k=[],e=-1,g=0,h=function(){if("undefined"==typeof uc3dBuffer)return!1;g=0;return!0},l=function(b){uc3dBuffer[g++]=b},n=function(b){uc3dBuffer[g++]=b},m=function(b,f,a){uc3dBuffer[g++]=a;for(var c=f;c<f+a;++c)for(var q=coerce.toHomog(d(b[c])),e=0;3>e;e++)uc3dBuffer[g++]=q[e]},u=function(b){var f=b.length;uc3dBuffer[g++]=f;for(var a=0;a<f;++a)for(var c=coerce.toHomog(b[a]),d=0;3>d;d++)uc3dBuffer[g++]=
c[d]},r=function(b,f,a){var c=null,q=f,e=null;f={color:function(b){return c=coerce.toColor(b)},alpha:function(b){return coerce.toInterval(0,1,b)},shininess:function(b){return coerce.toInterval(0,128,b)},size:function(b){return q=coerce.toReal(b)},topology:function(b){return e=coerce.toString(b,e).toLowerCase()}};for(var h in b){var k=f[h];null!=k&&k(d(b[h]))}null!=c&&(uc3dBuffer[g++]=1,uc3dBuffer[g++]=c[0],uc3dBuffer[g++]=c[1],uc3dBuffer[g++]=c[2]);if(null!=a)for(uc3dBuffer[g++]=2,uc3dBuffer[g++]=
a.length,b=0;b<a.length;++b)h=coerce.toColor(a[b]),uc3dBuffer[g++]=h[0],uc3dBuffer[g++]=h[1],uc3dBuffer[g++]=h[2];null!=q&&(uc3dBuffer[g++]=0,uc3dBuffer[g++]=q);null!=e&&(uc3dBuffer[g++]=3,"close"==e?uc3dBuffer[g++]=1:uc3dBuffer[g++]=0);uc3dBuffer[g]=-1};c("clear3d",0,function(b,f){if(0==h())return a;gameInstance.SendMessage("Manager","Clear3D","");k=[];e=-1;g=0;return a});c("begin3d",0,function(b,f){return t("Default",f,!0)});c("begin3d",1,function(b,f){return t(coerce.toString(d(b[0])),f,!0)});
c("createprototype3d",1,function(b,f){return t(coerce.toString(d(b[0])),f,!1)});var t=function(b,f,c){if(-1!=e||0==h())return a;n(c);gameInstance.SendMessage("Manager","Begin3D",b);e=Math.floor(uc3dBuffer[0]);k[e]={id:e,name:{ctype:"string",value:b},active:c,init:!1,start:null,update:null,collisionenter:null};return{ctype:"number",value:{real:e,imag:0}}};c("instantiate3d",2,function(b,f){return{ctype:"number",value:{real:v(b,f,!0),imag:0}}});c("extends3d",1,function(b,f){var a=-1;-1==e&&(e=a=v(b,
f,!1));return{ctype:"number",value:{real:a,imag:0}}});var v=function(b,f,a){f=-1;if(0==h())return f;var c=coerce.toInt(d(b[0])),e=k[c];e&&(l(c),n(a),a&&m(b,1,1),gameInstance.SendMessage("Manager","Instantiate3D",""),f=Math.floor(uc3dBuffer[0]),b=JSON.parse(JSON.stringify(e)),b.id=f,b.active=a,b.init=!1,k[f]=b);return f};c("end3d",0,function(b,f){if(-1==e||0==h())return a;gameInstance.SendMessage("Manager","End3D","");e=-1;return a});c("oncollisionenter3d",2,function(b,f){f=coerce.toInt(d(b[0]));b=
coerce.toInt(d(b[1]));f=k[f];if(!f)return a;null!=f.collisionenter&&(e=f.id,cdy.evokeCS(f.collisionenter+"("+b+");"));e=-1;return a});c("destroy3d",1,function(b,a){return w(e,b,0,a)});c("destroy3d",2,function(b,a){return w(coerce.toInt(d(b[0])),b,1,a)});var w=function(b,f,c,e){if(-1==b||0==h())return a;f=coerce.toReal(d(f[c]));l(b);n(f);gameInstance.SendMessage("Manager","Destroy3D","");return a};c("ondestroy3d",1,function(b,f){b=coerce.toInt(d(b[0]));delete k[b];return a});c("draw3d",1,function(b,
f){if(-1==e||0==h())return a;m(b,0,1);r(f,null,null);gameInstance.SendMessage("Manager","AddPoint3D","");return a});c("draw3d",2,function(b,f){if(-1==e||0==h())return a;m(b,0,2);r(f,null,null);gameInstance.SendMessage("Manager","AddLine3D","");return a});c("connect3d",1,function(b,a){return x(b,a)});c("connect3d",2,function(b,a){return x(b,a)});var x=function(b,f){if(-1==e||0==h())return a;u(coerce.toList(d(b[0])));var c=null;2==b.length&&(c=coerce.toList(d(b[1])));r(f,null,c);gameInstance.SendMessage("Manager",
"AddLine3D","");return a};c("fillpoly3d",1,function(b,f){if(-1==e||0==h())return a;u(coerce.toList(d(b[0])));r(f,null,null);gameInstance.SendMessage("Manager","AddPolygon3D","");return a});c("drawsphere3d",2,function(b,f){if(-1==e||0==h())return a;m(b,0,1);b=coerce.toReal(d(b[1]));r(f,b,null);gameInstance.SendMessage("Manager","AddSphere3D","");return a});c("setactive3d",1,function(b,a){return y(e,b,0,a)});c("setactive3d",2,function(b,a){return y(coerce.toInt(d(b[0])),b,1,a)});var y=function(b,f,
c,e){if(-1==b||0==h())return a;e=k[b];if(!e)return a;f=coerce.toBool(d(f[c+1]));e.active=f;l(b);n(f);gameInstance.SendMessage("Manager","SetActive3D","");return a};c("usegravity3d",1,function(b,a){return z(e,b,0,a)});c("usegravity3d",2,function(b,a){return z(coerce.toInt(d(b[0])),b,1,a)});var z=function(b,f,c,e){if(-1==b||0==h())return a;f=coerce.toBool(d(f[c]));l(b);n(f);gameInstance.SendMessage("Manager","UseGravity3D","");return a};c("addcollider3d",0,function(b,a){return A(e,b,a)});c("addcollider3d",
1,function(b,a){return A(coerce.toInt(d(b[0])),b,a)});var A=function(b,c,d){if(-1==b||0==h())return a;l(b);gameInstance.SendMessage("Manager","AddCollider3D","");return a};c("setmass3d",1,function(b,a){return B(e,b,0,a)});c("setmass3d",2,function(b,a){return B(coerce.toInt(d(b[0])),b,1,a)});var B=function(b,c,e,g){if(-1==b||0==h())return a;c=coerce.toReal(d(c[e]));l(b);n(c);gameInstance.SendMessage("Manager","SetMass3D","");return a};c("get3d",1,function(b,a){return C(e,b,0,a)});c("get3d",2,function(b,
a){return C(coerce.toInt(d(b[0])),b,1,a)});var C=function(b,c,e,g){if(-1==b||0==h())return a;b=k[b];if(!b)return a;c=coerce.toString(d(c[e]));return b[c]?b[c]:a};c("set3d",2,function(b,a){return D(e,b,0,a)});c("set3d",3,function(b,a){return D(coerce.toInt(d(b[0])),b,1,a)});var D=function(b,c,e,g){if(-1==b||0==h())return a;b=k[b];if(!b)return a;g=coerce.toString(d(c[e]));b[g]=d(c[e+1]);return a};c("setstart3d",1,function(b,a){return p(e,"start","();",b,0,a)});c("setstart3d",2,function(b,a){return p(coerce.toInt(d(b[0])),
"start","();",b,1,a)});c("setupdate3d",1,function(b,a){return p(e,"update","();",b,0,a)});c("setupdate3d",2,function(b,a){return p(coerce.toInt(d(b[0])),"update","();",b,1,a)});c("setcollisionenter3d",1,function(b,a){return p(e,"collisionenter","",b,0,a)});c("setcollisionenter3d",2,function(b,a){return p(coerce.toInt(d(b[0])),"collisionenter","",b,1,a)});var p=function(b,c,d,e,g,h){if(-1==b)return a;b=k[b];if(!b)return a;if("function"!==e[g].ctype)return console.log("argument is not a function"),
a;b[c]=e[g].oper.replace(/\$.*/g,d);return a};c("update3d",0,function(b,c){if(null==cdy)return a;k.forEach(function(b){b.active&&(b.init||null==b.start||(e=b.id,cdy.evokeCS(b.start),b.init=!0),null!=b.update&&(e=b.id,cdy.evokeCS(b.update)))});e=-1;return a});c("setposition3d",1,function(b,a){return E(e,b,0,a)});c("setposition3d",2,function(b,a){return E(coerce.toInt(d(b[0])),b,1,a)});var E=function(b,c,d,e){if(-1==b||0==h())return a;l(b);m(c,d,1);gameInstance.SendMessage("Manager","SetPosition3D",
"");return a};c("getposition3d",0,function(b,a){return F(e,b,0,a)});c("getposition3d",1,function(b,a){return F(coerce.toInt(d(b[0])),b,1,a)});var F=function(b,c,d,e){if(-1==b||0==h())return a;l(b);gameInstance.SendMessage("Manager","GetPosition3D","");return{ctype:"list",value:[{ctype:"number",value:{real:uc3dBuffer[0],imag:0}},{ctype:"number",value:{real:uc3dBuffer[1],imag:0}},{ctype:"number",value:{real:uc3dBuffer[2],imag:0}}]}};c("setrotation3d",1,function(b,a){return G(e,b,0,a)});c("setrotation3d",
2,function(b,a){return G(coerce.toInt(d(b[0])),b,1,a)});var G=function(b,c,d,e){if(-1==b||0==h())return a;l(b);m(c,d,1);gameInstance.SendMessage("Manager","SetRotation3D","");return a};c("setvelocity3d",1,function(a,c){return H(e,a,0,c)});c("setvelocity3d",2,function(a,c){return H(coerce.toInt(d(a[0])),a,1,c)});var H=function(b,c,d,e){if(-1==b||0==h())return a;l(b);m(c,d,1);gameInstance.SendMessage("Manager","SetVelocity3D","");return a};c("getkey3d",1,function(b,c){c=!1;if(0==h())return a;gameInstance.SendMessage("Manager",
"GetKey3D",coerce.toString(d(b[0])));uc3dBuffer[0]&&(c=!0);return{ctype:"boolean",value:c}})});var coerce={toList:function(c,a){a=void 0===a?null:a;return"list"!==c.ctype?(console.log("argument is not a list"),a):c.value},toHomog:function(c,a,d){a=void 0===a?[0,0,0,0]:a;d=void 0===d?3:d;c=coerce.toList(c);if(null===c)return a;a=c.map(coerce.toReal);a.length>d+1&&(console.log("Coordinate vector too long."),a=a.slice(0,d+1));for(;a.length<d;)a.push(0);a.length===d&&a.push(1);return a},toDirection:function(c,a){a=void 0===a?[0,0,0]:a;c=coerce.toList(c);if(null===c)return a;a=c.map(coerce.toReal);
3<a.length&&(console.log("Coordinate vector too long."),a=a.slice(0,3));for(;3>a.length;)a.push(0);return a},toDirectionPoint:function(c,a){a=void 0===a?[0,0,0,0]:a;c=coerce.toDirection(c,a);c!==a&&(c[3]=0);return c},toColor:function(c,a){a=void 0===a?[.5,.5,.5]:a;if("number"===c.ctype){var d=coerce.toInterval(0,1,c);if(!isNaN(d))return[d,d,d]}c=coerce.toList(c);return null===c?a:3!=c.length?(console.log("Not an RGB color vector"),a):c.map(function(a){return coerce.toInterval(0,1,a)})},toReal:function(c,
a){a=void 0===a?Number.NaN:a;if("number"!==c.ctype)return console.log("argument is not a number"),a;c=c.value;a=c.real;0!==c.imag&&console.log("complex number is not real");return a},toInt:function(c,a){a=void 0===a?Number.NaN:a;if("number"!==c.ctype)return console.log("argument is not a number"),a;a=c.value;c=a.real;a=a.imag;0!==a&&console.log("complex number is not real");a=Math.round(c);a!==c&&console.log("number is not an integer");return a},clamp:function(c,a,d){return d<c?c:d>a?a:d},toInterval:function(c,
a,d,k){k=void 0===k?Number.NaN:k;return coerce.clamp(c,a,coerce.toReal(d,k))},toString:function(c,a){a=void 0===a?null:a;if("string"===c.ctype)return c.value;console.log("argument is not a string");return a},toEnum:function(c,a,d){d=void 0===d?null:d;a=coerce.toString(a,d);if(a!==d&&-1!==c.indexOf(a))return a;console.log("argument is not one of "+c.join(", "));return d},toBool:function(c,a){if("boolean"===c.ctype)return c.value;console.log("argument is not boolean");return a}};
}).call(this);

